<script>


  	/*
  *THIS FUNCTION CALL THE getData() FUNCTION IN THE Code.gs FILE, 
  *AND PASS RETURNED DATA TO showData() FUNCTION
  */
  google.script.run.withSuccessHandler(showData).getData();
  google.script.run.withSuccessHandler(showDataKomunikaty).getDataKomunikaty();


  //THIS FUNCTION GENERATE THE DATA TABLE FROM THE DATA ARRAY
function showData(dataArray) {
  $(document).ready(function () {
    $('#data-table').DataTable({
      data: dataArray,
      columns: [
        {"title": "Obszar"},
        {"title": "Numer ID Pracownika 1"},
        {"title": "Numer Zlecenia"},
        {"title": "STATUS"},
        {"title": "Liczba Sztuk"},
        {"title": "Komentarz"},
        {"title": "Data"},
        {"title": "Numer ID Pracownika 2"}
      ],
      columnDefs: [
        {
          targets: "_all",
          defaultContent: ""
        }
      ]
    });
  });
}


  //THIS FUNCTION GENERATE THE DATA TABLE FROM THE DATA ARRAY
function showDataKomunikaty(dataArray) {
  $(document).ready(function () {
    $('#data-table1').DataTable({
      data: dataArray,
      columns: [
        {"title": "Numer"},
        {"title": "Typ"},
        {"title": "Tresc"},
        {"title": "Data"},
      ],
      columnDefs: [
        {
          targets: "_all",
          defaultContent: ""
        }
      ]
    });
  });
}

  function preventFormSubmit(){
    var forms=document.querySelectorAll('form');
    for (var i=0;i<forms.length;i++){
      forms[i].addEventListener('submit',function(event){
        event.preventDefault();
      });
    }
  }
  
window.addEventListener('load',preventFormSubmit);


    function handleFormSubmit(formObject) {
        google.script.run.processForm(formObject);
        document.getElementById("myForm").reset();

        // Get the selected option from the dropdown
        var selectedZlecenie = document.getElementById("zlecenie").value;

        // Find the corresponding data in the dropdown and set it in the input field
        var zlecenieOptions = document.getElementById("zlecenie").options;
        for (var i = 0; i < zlecenieOptions.length; i++) {
            if (zlecenieOptions[i].value === selectedZlecenie) {
                document.getElementById("nazwa_czesci").value = zlecenieOptions[i].text.split(' | ')[1];
                document.getElementById("nazwa_operacji").value = zlecenieOptions[i].text.split(' | ')[2];

                break;
            }
        }
    }


</script>
